# 扫码自动抽签功能 - 测试说明

## 功能概述

用户通过扫描带有 `status` 参数的小程序码进入小程序时，会自动抽取对应签号的签文并展示。

例如：用户线下抽到第4签，扫描该签上的二维码后，小程序会自动开启第4签。

---

## 测试方法

### 方法一：在微信开发者工具中模拟扫码进入

1. **打开微信开发者工具**
2. **进入编译模式设置**
   - 点击顶部工具栏的「普通编译」下拉菜单
   - 选择「添加编译模式」

3. **配置编译模式**
   - 模式名称：`扫码测试-第4签`
   - 启动页面：`pages/home/home`
   - 启动参数：`scene=status%3D4`
   - 点击「确定」

4. **运行测试**
   - 选择刚创建的编译模式
   - 点击「编译」按钮
   - 观察小程序是否自动开启第4签

### 方法二：通过 URL 参数测试

在微信开发者工具的地址栏中输入：
```
pages/home/home?scene=status%3D4
```

---

## 测试用例

### 1. 正常场景测试

| 测试用例 | scene 参数 | 预期结果 |
|---------|-----------|---------|
| 第1签 | `status=1` | 自动开启第1签（大吉-飞龙在天） |
| 第4签 | `status=4` | 自动开启第4签（大吉-高山流水） |
| 第30签 | `status=30` | 自动开启第30签 |
| 第61签 | `status=61` | 自动开启第61签（最后一签） |

### 2. 边界情况测试

| 测试用例 | scene 参数 | 预期结果 |
|---------|-----------|---------|
| 签号为0 | `status=0` | 提示「签号无效，请重新扫码」 |
| 签号为62 | `status=62` | 提示「签号无效，请重新扫码」 |
| 签号为负数 | `status=-1` | 提示「签号无效，请重新扫码」 |
| 无效格式 | `status=abc` | 提示「签号无效，请重新扫码」 |
| 空参数 | `status=` | 不触发自动抽签 |
| 无scene参数 | （无） | 正常进入首页，可手动摇签 |

### 3. 多参数测试

| 测试用例 | scene 参数 | 预期结果 |
|---------|-----------|---------|
| 多个参数 | `status=4&type=offline` | 自动开启第4签（忽略其他参数） |

---

## 验证要点

### ✅ 功能验证
- [ ] 扫码后自动触发抽签动画
- [ ] 显示提示「正在开启第X签」
- [ ] 播放摇签音效
- [ ] 签条弹出动画正常
- [ ] 签文卡片正确展示
- [ ] 语音播报签诗正常
- [ ] 签文内容与签号匹配

### ✅ 交互验证
- [ ] 自动抽签后可以点击「继续抽签」
- [ ] 继续抽签后可以手动摇签
- [ ] 自动抽签过程中不能重复触发

### ✅ 异常处理
- [ ] 无效签号有友好提示
- [ ] 参数格式错误有提示
- [ ] 不影响正常的手动摇签功能

---

## 控制台日志

测试时注意观察控制台输出：

```javascript
// 正常情况
扫码参数: status=4
自动抽取第 4 签

// 异常情况
解析扫码参数失败: [错误信息]
```

---

## 注意事项

1. **scene 参数需要 URL 编码**
   - `status=4` 编码后为 `status%3D4`
   - 在微信开发者工具中测试时需要使用编码后的值

2. **真实环境测试**
   - 开发者工具测试通过后，需要在真机上测试
   - 真机测试需要生成真实的小程序码

3. **签号范围**
   - 有效签号范围：1-61
   - 超出范围会提示错误

---

## 下一步：生成小程序码

测试通过后，参考《二维码生成说明.md》文档生成带参数的小程序码。

